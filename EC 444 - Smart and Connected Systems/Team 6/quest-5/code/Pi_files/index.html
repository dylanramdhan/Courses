<!--Team6-Xiong-Ramdhan-Gumusayak-Ramondo - 12/1     -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Data</title>
  <!-- Include CanvasJS library -->
  <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</head>
<script src="/socket.io/socket.io.js"></script>
<script>
</script>

<body>
  <div id="tableContainer"></div>
  <!-- <div id="chartContainer" style="height: 300px; width: 100%;"></div> -->
  <script>
    // Create an empty data array for the chart
    const columnNames = ['meterID', 'status', 'time', 'FobID'];

// Function to generate HTML table
// This code block was generated by Mete using {chat.openai.com GPT-3.5} on {12/1/2023}
function generateTable(dataArray, columnNames) {
  console.log(dataArray)
  var existingTables = document.querySelectorAll('table');
    existingTables.forEach(function(table) {
        table.parentNode.removeChild(table);
    });
    // Create table element
    var table = document.createElement('table');

    // Create table header
    var thead = document.createElement('thead');
    var headerRow = document.createElement('tr');

    // Add column names to the header
    columnNames.forEach(function (columnName) {
        var th = document.createElement('th');
        th.textContent = columnName;
        headerRow.appendChild(th);
    });

    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Create table body
    var tbody = document.createElement('tbody');

    // Add data rows to the table
    dataArray.forEach(function (dataRow) {
        var row = document.createElement('tr');

        // Add data cells to the row
        dataRow.forEach(function (dataCell) {
            var td = document.createElement('td');
            td.textContent = dataCell;
            row.appendChild(td);
        });

        tbody.appendChild(row);
    });

    table.appendChild(tbody);

    // Return the generated table
    document.getElementById('tableContainer').appendChild(table);
    return table;
}
    // Listen for data delivered to the socket (from the node server)
    const socket = io.connect();
    socket.on("data", (data) => {
      // Parse the received data 
      generateTable(data, columnNames);
    });
  </script>
</body>

</html>
